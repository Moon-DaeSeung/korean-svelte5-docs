---
title: 키가 있는 each 블록
---

기본적으로 `each` 블록의 값을 수정할 때, 블록의 _끝_에서 DOM 노드를 추가하고 제거하며, 변경된 값들을 업데이트합니다. 이것이 원하는 동작이 아닐 수 있습니다.

설명하는 것보다 보여주는 것이 더 쉽습니다. `Thing.svelte` 내부에서 `name`은 동적 prop이지만 `emoji`는 상수입니다.

'Remove first thing' 버튼을 몇 번 클릭하고 어떤 일이 일어나는지 보세요:

1. 마지막 컴포넌트를 제거합니다.
2. 그런 다음 남아있는 DOM 노드의 `name` 값을 업데이트하지만, 이모지는 업데이트하지 않습니다.

> [!NOTE] React를 사용하다 오셨다면 이상하게 느껴질 수 있습니다. React에서는 상태가 변경될 때 전체 컴포넌트가 다시 렌더링되는 것에 익숙하기 때문입니다. Svelte는 다르게 작동합니다: 컴포넌트는 한 번 '실행'되고, 이후의 업데이트는 '세밀하게' 이루어집니다. 이는 더 빠르고 더 많은 제어가 가능합니다.

이를 해결하는 한 가지 방법은 `emoji`를 [`$derived`](derived-state) 값으로 만드는 것입니다. 하지만 마지막 `<Thing>` 컴포넌트를 제거하고 다른 모든 것을 업데이트하는 것보다 첫 번째 `<Thing>` 컴포넌트를 완전히 제거하는 것이 더 합리적입니다.

이를 위해 `each` 블록의 각 반복에 대해 고유한 _키_를 지정합니다:

```svelte
/// file: App.svelte
{#each things as thing (thing.id)}
	<Thing name={thing.name}/>
{/each}
```

> [!NOTE] Svelte는 내부적으로 `Map`을 사용하기 때문에 키로 어떤 객체든 사용할 수 있습니다 — 즉, `(thing.id)` 대신 `(thing)`을 사용할 수 있습니다. 하지만 문자열이나 숫자를 사용하는 것이 일반적으로 더 안전합니다. API 서버에서 새로운 데이터로 업데이트할 때와 같이 참조 동등성 없이도 식별성이 유지되기 때문입니다.
